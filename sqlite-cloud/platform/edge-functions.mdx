---
title: Edge Functions
description: SQLite Cloud offers powerful edge functions for performant data processing and third-party integrations.
category: platform
status: publish
slug: edge-functions
---

Edge Functions are server-side functions that run directly within your database environment. Edge functions in SQLite Cloud ensure maximum performance and minimal latency by running functions on the same server as your database.

You can write edge functions directly in the SQLite Cloud dashboard using JavaScript, TypeScript, or SQL. Importing modules is not currently supported.

Edge functions can be called remotely over HTTP or Websockets via API, or triggered by database events via SQLite Cloud [Webhooks](https://docs.sqlitecloud.io/docs/webhooks). Each function runs in an isolated environment using the Bun runtime. 

Turning on linearizable reads ensures strong consistency, but may introduce some latency. When eventual consistency is sufficient, we recommend leaving linearizable reads off.

## Getting Started
1. Navigate to the Edge Functions page from your dashboard.
2. Under "Development", select "Edge Function", then click the "Create" button.
3. Write and test your function.
    1. Select the database you want to access and an API key if necessary
    2. When you're finished, click deploy.

#### Note:
Functions should return a JSON-serializable object with a data field:
```js
return {
  data: {
    // your return object
  }
}
```

### Authorization
When creating an edge function, you have the option to assign an API key. If an API key is assigned, any calls to the edge function will automatically authenticate access to the associated database using that API key.

If you don't assign an API key during creation, you must include an API key with each request to the edge function's URL. In this case, you have two options for adding the API key:
- As a query parameter: Add `?apikey=YOUR_API_KEY` to the URL
- In the request body: Include `apikey` as a variable in your request data

### Execution
When it comes to executing an edge function, you have two HTTP methods at your disposal: GET and POST. Your choice between these methods should be based on whether you need to include a request body. Use GET for simple requests without a body, and POST when you need to send data in the request body.

Edge functions are highly flexible. Unlike traditional REST APIs, the HTTP method you use (GET or POST) doesn't determine the function's behavior. Instead, think of an edge function as a piece of code that runs close to your database and can perform any operation you define. The edge function's behavior is determined by your code, not the HTTP method used to call it.

Within your edge function, you have access to two key pieces of information:
- Query parameters: Accessible via `request.params`
- Request body: Accessible via `request.data`

This allows you to work with any data sent along with the request, giving you full control over your function's inputs.

### Testing
When testing your edge function in the dashboard, you'll notice that the "Test" button works even without an API key selected. This is because it uses your dashboard user privileges. 

If you try to access the edge function's URL directly from a browser without including an API key, you'll receive an "Unauthorized" error. Always ensure you're including proper authorization in your requests to avoid this issue.



## Guides
### Interacting with your Database
Use the global `connection` object to access and manipulate your database.
```js
const customers = await connection.sql`SELECT * FROM customers;`
return {
  data: customers
}
```

Select the database you would like to access from the "Database" dropdown, or select the database you want to use in your SQL query with the [USE command](https://docs.sqlitecloud.io/docs/database-commands).

```js
const customers = await connection.sql`USE DATABASE chinook.sqlite; SELECT * FROM customers;`;
return {
  data: customers
}
```

### Storing and Accessing Environment Variables
Environment variables can be accessed and stored with the ENV command. ENV variables are stored in the server settings file and are project-specific.
Use the following commands to set and read values in your server settings file:

* [LIST ENV](https://docs.sqlitecloud.io/docs/settings-commands#list-env)
* [SET ENV](https://docs.sqlitecloud.io/docs/settings-commands#set-env) key VALUE value
* [GET ENV](https://docs.sqlitecloud.io/docs/settings-commands#get-env) key
* [REMOVE ENV](https://docs.sqlitecloud.io/docs/settings-commands#remove-env) key

You can also add environment variables in the UI by navigating to the "Environment Variables" section and clicking the "Create" button.


### Handling Errors
In case of error we return an HTTP error code and a JSON with the error message. Manually throwing an error in your code results in a 500 response. You may also return an error. 

## Examples

### Assigning and Notifying a Support Rep on User Sign up

```js
// Get secret from database
const slackWebhookEndpoint = await connection.sql`GET ENV slack_webhook_endpoint`;

// Get record sent in body via webhook
const content = request.data;
const database = content.database;
const primaryKey = content.data[0];
const newCustomer = await connection.sql`USE DATABASE ${database}; SELECT * FROM customers WHERE CustomerId = ${primaryKey};`;

// Sample business logic - assign and notify support rep
// Get reps from database
const reps = await connection.sql`SELECT id, name, country FROM reps`;
const rep = reps.find(({ country }) => country === newCustomer.country.toLowerCase());

// Define helpers to assign and notify
const assignRep = async (repId, customerId) => await connection.sql`UPDATE customers SET SupportRepId = ${repId} WHERE CustomerId = ${customerId}`;
const notifyRep = async (repName, customer) => {
    const message = `@${repName}: New User Sign Up - ${JSON.stringify(customer)}`
    try {
        await fetch(slackWebhookEndpoint, { body: JSON.stringify({ text: message }), method: 'POST', 'Content-type': 'application/json'  });
    } catch (err) {
        await fetch(slackWebhookEndpoint, { body: JSON.stringify({ text: err }), method: 'POST', 'Content-type': 'application/json'  });
    }
} 

// Call async functions
await assignRep(rep.id, newCustomer.id);
await notifyRep(rep.name, newCustomer);

return {
    data: 'OK'
}
```